from pgmpy.models import BayesianNetwork
from pgmpy.factors.discrete import TabularCPD
from pgmpy.inference import VariableElimination

model = BayesianNetwork([("Carte1j1", "Carte2j1"),
                         ("Carte1j1", "Carte1j2"), ("Carte2j1", "Carte1j2"),
                         ("Carte1j1", "Carte2j2"), ("Carte2j1", "Carte2j2"), ("Carte1j2", "Carte2j2"), 
                         ("Carte1j1", "Deciziej1"), ("Carte2j1", "Deciziej1"),
                         ("Deciziej1", "Deciziej2"), 
                         ("Carte1j2", "Deciziej2"), ("Carte2j2", "Deciziej2"), 
                         ("Deciziej2", "Deciziej1_prim"),
                         ("Carte1j1", "Deciziej1_prim"), ("Carte2j1", "Deciziej1_prim")
                        ])

# A = 0, Kf = 1, Ki = 2, Qf = 3, Qi = 4

cpd_carte1j1 = TabularCPD("Carte1j1", 5, [[0.2], [0.2], [0.2], [0.2], [0.2]])
cpd_carte2j1 = TabularCPD("Carte2j1", 5, [ [0, 0.25, 0.25, 0.25, 0.25], 
                                        [0.25, 0, 0.25, 0.25, 0.25], 
                                        [0.25, 0.25, 0, 0.25, 0.25],
                                        [0.25, 0.25, 0.25, 0, 0.25], 
                                        [0.25, 0.25, 0.25, 0.25, 0] ],
                         evidence=["Carte1j1"],
                         evidence_card=[5]
                         )

cpd_carte1j2 = TabularCPD("Carte1j2", 5, [ 
                                        [0,0,0,0,0,
                                        0,0,0.33,0.33,0.33,
                                        0,0.33,0,0.33,0.33,
                                        0,0.33,0.33,0,0.33,
                                        0,0.33,0.33,0.33,0,
                                        ],
                                          
                                        [1,0,0.33,0.33,0.33,
                                         0,1,0,0,0,
                                         0.33,0,1,0.33,0.33,
                                         0.33,0,0.33,1,0.33,
                                         0.33,0,0.33,0.33,1],
                                         
                                        [0,0.33,0,0.33,0.33,
                                         0.33,0,0,0.33,0.33,
                                         0,0,0,0,0,
                                         0.33,0.33,0,0,0.33,
                                         0.33,0.33,0,0.33,0],
                                        
                                        [0,0.33,0.33,0,0.33,
                                        0.33,0,0.33,0,0.33,
                                        0.33,0.33,0,0,0.33,
                                        0,0,0,0,0,
                                        0.33,0.33,0.33,0,0],
                                         
                                        [0,0.33,0.33,0.33,0,
                                         0.33,0,0.33,0.33,0,
                                         0.33,0.33,0,0.33,0,
                                         0.33,0.33,0.33,0,0,
                                         0,0,0,0,0]
                                        ],
                         evidence=["Carte1j1", "Carte2j1"],
                         evidence_card=[5,5]
                        )

cpd_carte2j2 = TabularCPD("Carte2j2", 5, [ 
                                        [0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0,
                                         0,0,0,0,0, 0,0,0,0,0, 0,0,0,0.5,0.5, 0,0,0.5,0,0.5, 0,0,0.5,0.5,0,
                                         0,0,0,0,0, 0,0,0,0.5,0.5, 0,0,0,0,0, 0,0.5,0,0,0.5, 0,0.5,0,0.5,0,
                                         0,0,0,0,0, 0,0,0.5,0,0.5, 0,0.5,0,0,0.5, 0,0,0,0,0, 0,0.5,0.5,0,0,
                                         0,0,0,0,0, 0,0,0.5,0.5,0, 0,0.5,0,0.5,0, 0,0.5,0.5,0,0, 0,0,0,0,0,
                                        ],
                                          
                                        [1,1,1,1,1, 1,1,0,0,0, 1,0,1,0.5,0.5, 1,0,0.5,1,0.5, 1,0,0.5,0.5,1,
                                         1,1,0,0,0, 1,1,1,1,1, 0,1,1,0,0, 0,1,0,1,0, 0,1,0,0,1,
                                         1,0,1,0.5,0.5, 0,1,1,0,0, 1,1,1,1,1, 0.5,0,1,1,0.5, 0.5,0,1,0.5,1,
                                         1,0,0.5,1,0.5, 0,1,0,1,0, 0.5,0,1,1,0.5, 1,1,1,1,1, 0.5,0,0.5,1,1,
                                         1,0,0.5,0.5,1, 0,1,0,0,1, 0.5,0,1,0.5,1, 0.5,0,0.5,1,1, 1,1,1,1,1,
                                        ],
                                         
                                        [0,0,0,0,0, 0,0,0,0.5,0.5, 0,0,0,0,0, 0,0.5,0,0,0.5, 0,0.5,0,0.5,0,
                                         0,0,0,0.5,0.5, 0,0,0,0,0, 0,0,0,0,0, 0.5,0,0,0,0.5, 0.5,0,0,0.5,0,
                                         0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0,
                                         0,0.5,0,0,0.5, 0.5,0,0,0,0.5, 0,0,0,0,0, 0,0,0,0,0, 0.5,0.5,0,0,0,
                                         0,0.5,0,0.5,0, 0.5,0,0,0.5,0, 0,0,0,0,0, 0.5,0.5,0,0,0, 0,0,0,0,0,
                                        ],
                                        
                                        [0,0,0,0,0, 0,0,0.5,0,0.5, 0,0.5,0,0,0.5, 0,0,0,0,0, 0,0.5,0.5,0,0,
                                         0,0,0.5,0,0.5, 0,0,0,0,0, 0.5,0,0,0,0.5, 0,0,0,0,0, 0.5,0,0.5,0,0,
                                         0,0.5,0,0,0.5, 0.5,0,0,0,0.5, 0,0,0,0,0, 0,0,0,0,0, 0.5,0.5,0,0,0,
                                         0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0,
                                         0,0.5,0.5,0,0, 0.5,0,0.5,0,0, 0.5,0.5,0,0,0, 0,0,0,0,0, 0,0,0,0,0,
                                        ],
                                         
                                        [0,0,0,0,0, 0,0,0.5,0.5,0, 0,0.5,0,0.5,0, 0,0.5,0.5,0,0, 0,0,0,0,0,
                                         0,0,0.5,0.5,0, 0,0,0,0,0, 0.5,0,0,0.5,0, 0.5,0,0.5,0,0, 0,0,0,0,0,
                                         0,0.5,0,0.5,0, 0.5,0,0,0.5,0, 0,0,0,0,0, 0.5,0.5,0,0,0, 0,0,0,0,0,
                                         0,0.5,0.5,0,0, 0.5,0,0.5,0,0, 0.5,0.5,0,0,0, 0,0,0,0,0, 0,0,0,0,0,
                                         0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0,
                                        ]
                                        ],
                         evidence=["Carte1j1", "Carte2j1", "Carte1j2"],
                         evidence_card=[5,5,5]
                        )

# Decizie = 0 <=> jucatorul a asteptat    

cpd_deciziej1 = TabularCPD("Deciziej1", 2, [ [0, 0, 0, 0, 0,
                                              0, 0, 0.66, 0.66, 0.66,
                                              0, 0.66, 0, 1, 1,
                                              0, 0.66, 1, 0, 1,
                                              0, 0.66, 1, 1, 0
                                              ], 
                                            [1, 1, 1, 1, 1,
                                             1, 1, 0.33, 0.33, 0.33,
                                             1, 0.33, 1, 0, 0,
                                             1, 0.33, 0, 1, 0,
                                             1, 0.33, 0, 0, 1
                                             ] ], 
                           evidence=["Carte1j1", "Carte2j1"],
                           evidence_card=[5,5]
                           )
cpd_deciziej2 = TabularCPD("Deciziej2", 2, [ [0,0, 0,0, 0,0, 0,0, 0,0,
                                              0,0, 0,0, 0,1, 0,1, 0,1,
                                              0,0, 0,1, 0,0, 1,1, 1,1,
                                              0,0, 0,1, 1,1, 0,0, 1,1,
                                              0,0, 0,1, 1,1, 1,1, 0,0,
                                              ],
                                            
                                             [1,1, 1,1, 1,1, 1,1, 1,1,
                                              1,1, 1,1, 1,0, 1,0, 1,0,
                                              1,1, 1,0, 1,1, 0,0, 0,0,
                                              1,1, 1,0, 0,0, 1,1, 0,0,
                                              1,1, 1,0, 0,0, 0,0, 1,1,
                                              ]
                                            ],
                           evidence=["Carte1j2", "Carte2j2", "Deciziej1"],
                           evidence_card=[5, 5, 2]
                           )
cpd_deciziej1_prim = TabularCPD("Deciziej1_prim", 2, [ [0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0,
                                              0,0,0,0,0, 0,0,0.66,0.66,0.66, 0,0.66,0,1,1, 0,0.66,1,0,1, 0,0.66,1,1,0
                                              ],
                                             [1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1, 1,1,1,1,1,
                                              1,1,1,1,1, 1,1,0.33,0.33,0.33, 1,0.33,1,0,0, 1,0.33,0,1,0, 1,0.33,0,0,1
                                              ]
                                            ],
                                evidence=["Deciziej2", "Carte1j1", "Carte2j1"],
                                evidence_card=[2,5,5]
                                )


model.add_cpds(cpd_carte1j1, cpd_carte2j1, cpd_carte1j2, cpd_carte2j2, cpd_deciziej1, cpd_deciziej2, cpd_deciziej1_prim)
model.get_cpds()

print(model.check_model())